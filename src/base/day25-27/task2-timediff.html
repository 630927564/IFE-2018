<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>IFE ECMAScript - Clock</title>
</head>

<body>
    <select name="year" id="year-select"></select>年
    <select name="month" id="month-select"></select>月
    <select name="day" id="day-select"></select>日
    <select name="" id="hour-select"></select>时
    <select name="minite" id="minute-select"></select>分
    <select name="second" id="second-select"></select>秒
    <p id="result-wrapper">现在距离 2001年1月1日星期X HH:MM:SS 还有 X 天 X 小时 X 分 X 秒</p>
    <script>

        // 生成下拉菜单的option， 例： preOption("#year-select", 2000, 2040, 2018);
        function preOption(id, start, end, selected) {
            var select = document.querySelector(id);
            select.innerHtml = "";
            for (var i = start; i <= end; i++) {
                var option = document.createElement("option");
                option.value = i;
                option.innerText = checkTime(i);
                select.appendChild(option);
            }
            // 如果正确输入了默认选项，则设置，否则默认选中第一个
            if (selected != undefined && selected >= start && selected <= end) {
                select.selectedIndex = selected - start;
            } else {
                select.selectedIndex = 0;
            }
        }

        function initOption() {
            var now = new Date();
            var nowYear = now.getFullYear();
            // 默认显示前后20年
            preOption("#year-select", nowYear - 20, nowYear + 20, nowYear);
            var nowMonth = now.getMonth();
            preOption("#month-select", 1, 12, nowMonth + 1);
            var nowDay = now.getDate();
            preOption("#day-select", 1, getDays(nowYear, nowMonth), nowDay);
            var nowHours = now.getHours();
            preOption("#hour-select", 1, 23, nowHours);
            var nowMinutes = now.getMinutes();
            preOption("#minute-select", 1, 59, nowMinutes);
            var nowSeconds = now.getSeconds();
            preOption("#second-select", 1, 59, nowSeconds);
        }

        // 获取当前选中的时间，返回日期格式
        function getSelectedTime() {
            var year = getSelectedValue("#year-select");
            var month = getSelectedValue("#month-select");
            var day = getSelectedValue("#day-select");
            var hours = getSelectedValue("#hour-select");
            var minutes = getSelectedValue("#minute-select");
            var seconds = getSelectedValue("#second-select");
            var timeString = year + "-" + month + "-" + day + " " + hours + ":" + minutes + ":" + seconds;
            return new Date(timeString);
        }

        // 获取select下拉列表选中的value
        function getSelectedValue(id) {
            var obj = document.querySelector(id);
            return obj.options[obj.selectedIndex].value; // 选中值
        }

        // 指定日期返回星期几  字符串类型参数date: 2018-05-20
        function getWeekday(date) {
            var weekday = new Array(7);
            weekday[0] = "星期日";
            weekday[1] = "星期一";
            weekday[2] = "星期二";
            weekday[3] = "星期三";
            weekday[4] = "星期四";
            weekday[5] = "星期五";
            weekday[6] = "星期六";
            return weekday[date.getDay()];
        }

        // 根据年月计算出当月天数
        function getDays(y, m) {
            switch (m) {
                case 1: case 3: case 5: case 7: case 8: case 10: case 12:
                    return 31;
                case 4: case 6: case 9: case 11:
                    return 30;
                case 2:
                    //判断是否为闰年
                    return (y % 4 == 0 && y % 100 != 0 || y % 400 == 0) ? 29 : 28;
                default:
                    return "参数错误";
            }
        }

        // 当i<10,在前面补0
        function checkTime(i) {
            if (i < 10) { i = "0" + i }
            return i
        }
    </script>
</body>

</html>